<div class="section-{{ section.id }}-padding">
  <div class="video-container" style="padding-bottom: 56.25%;">
    {%- if section.settings.video_url != blank -%}
      <iframe
        src="{{ section.settings.video_url | replace: 'watch?v=', 'embed/' }}"
        allow="autoplay; encrypted-media"
        allowfullscreen
        loading="lazy"
      ></iframe>
    {%- elsif section.settings.video_file != blank -%}
      <video
        controls
        playsinline
        {% if section.settings.autoplay %}autoplay muted loop{% endif %}
        poster="{{ section.settings.cover_image | image_url: width: 1920 }}"
      >
        <source src="{{ section.settings.video_file | file_url }}" type="video/mp4">
      </video>
    {%- endif -%}
  </div>
</div>

{% schema %}
{
  "name": "Video Block",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "video_url",
      "id": "video_url",
      "label": "YouTube Video URL",
      "accept": ["youtube"]
    },
    {
      "type": "video",
      "id": "video_file",
      "label": "Video file"
    },
    {
      "type": "image_picker",
      "id": "cover_image",
      "label": "Cover image"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay video",
      "default": false
    }
  ],
  "presets": [
    {
      "name": "Video Block"
    }
  ]
}
{% endschema %}

<style>
  .video-section {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    margin-right: calc(-50vw + 50%);
  }

  .video-container {
    position: relative;
    width: 100%;
    height: 0;
    overflow: hidden;
  }

  .video-container iframe,
  .video-container video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .video-placeholder {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
  }
</style>
